<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Classify the Classical Dances of India - II | nareshr8</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Classify the Classical Dances of India - II" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Learn Identifying Classical Dances" />
<meta property="og:description" content="Learn Identifying Classical Dances" />
<link rel="canonical" href="https://nareshr8.github.io/ml_posts/fast-ai/icrawler/2018/11/08/learn-identifying-classical-dances.html" />
<meta property="og:url" content="https://nareshr8.github.io/ml_posts/fast-ai/icrawler/2018/11/08/learn-identifying-classical-dances.html" />
<meta property="og:site_name" content="nareshr8" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-11-08T00:00:00-06:00" />
<script type="application/ld+json">
{"datePublished":"2018-11-08T00:00:00-06:00","headline":"Classify the Classical Dances of India - II","description":"Learn Identifying Classical Dances","mainEntityOfPage":{"@type":"WebPage","@id":"https://nareshr8.github.io/ml_posts/fast-ai/icrawler/2018/11/08/learn-identifying-classical-dances.html"},"@type":"BlogPosting","url":"https://nareshr8.github.io/ml_posts/fast-ai/icrawler/2018/11/08/learn-identifying-classical-dances.html","dateModified":"2018-11-08T00:00:00-06:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/ml_posts/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://nareshr8.github.io/ml_posts/feed.xml" title="nareshr8" /><link rel="shortcut icon" type="image/x-icon" href="/ml_posts/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Classify the Classical Dances of India - II | nareshr8</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Classify the Classical Dances of India - II" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Learn Identifying Classical Dances" />
<meta property="og:description" content="Learn Identifying Classical Dances" />
<link rel="canonical" href="https://nareshr8.github.io/ml_posts/fast-ai/icrawler/2018/11/08/learn-identifying-classical-dances.html" />
<meta property="og:url" content="https://nareshr8.github.io/ml_posts/fast-ai/icrawler/2018/11/08/learn-identifying-classical-dances.html" />
<meta property="og:site_name" content="nareshr8" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-11-08T00:00:00-06:00" />
<script type="application/ld+json">
{"datePublished":"2018-11-08T00:00:00-06:00","headline":"Classify the Classical Dances of India - II","description":"Learn Identifying Classical Dances","mainEntityOfPage":{"@type":"WebPage","@id":"https://nareshr8.github.io/ml_posts/fast-ai/icrawler/2018/11/08/learn-identifying-classical-dances.html"},"@type":"BlogPosting","url":"https://nareshr8.github.io/ml_posts/fast-ai/icrawler/2018/11/08/learn-identifying-classical-dances.html","dateModified":"2018-11-08T00:00:00-06:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://nareshr8.github.io/ml_posts/feed.xml" title="nareshr8" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/ml_posts/">nareshr8</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/ml_posts/about/">About Me</a><a class="page-link" href="/ml_posts/search/">Search</a><a class="page-link" href="/ml_posts/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Classify the Classical Dances of India - II</h1><p class="page-description">Learn Identifying Classical Dances</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2018-11-08T00:00:00-06:00" itemprop="datePublished">
        Nov 8, 2018
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      4 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/ml_posts/categories/#fast-ai">fast-ai</a>
        &nbsp;
      
        <a class="category-tags-link" href="/ml_posts/categories/#icrawler">icrawler</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#look-into-the-images">Look into the images</a></li>
<li class="toc-entry toc-h2"><a href="#training-the-model">Training the model</a></li>
<li class="toc-entry toc-h2"><a href="#understanding-the-model">Understanding the model</a></li>
<li class="toc-entry toc-h2"><a href="#cleanup">Cleanup</a></li>
</ul><p>Now that we have downloaded the images <a href="https://nareshr8.github.io/2018-11-08-download-classical-dance/">here</a>. Our next step is to train the model to learn identifying classical dance images.</p>

<h2 id="look-into-the-images">
<a class="anchor" href="#look-into-the-images" aria-hidden="true"><span class="octicon octicon-link"></span></a>Look into the images</h2>

<p>First we will import the necessary package</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">fastai.vision</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastai</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</code></pre></div></div>

<p>Now that we imported all the libraries we want, we can take the next step. Load the images into various bunches such as training and testing sets.</p>

<p>We usually seed the random so that we can monitor the performance. If we see a improvement in accuracy, it must mean that our tuning worked and not that we were lucky to get the best data in the random shuffle.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="n">PATH</span><span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s">'./data/dances'</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">ImageDataBunch</span><span class="o">.</span><span class="n">from_folder</span><span class="p">(</span><span class="n">PATH</span><span class="p">,</span> <span class="n">valid_pct</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="s">"."</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">224</span><span class="p">,</span><span class="n">ds_tfms</span><span class="o">=</span><span class="n">get_transforms</span><span class="p">(),</span><span class="n">num_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">imagenet_stats</span><span class="p">)</span>
</code></pre></div></div>

<p>In the above code</p>
<ul>
  <li>We have made sure the same set of images are used evertime we randomly divide the dataset into training and test set.</li>
  <li>We provide the path in which all our images are available</li>
  <li>We create a Data Bunch which takes the parameter like
    <ul>
      <li>
<code class="highlighter-rouge">PATH</code> path of the images</li>
      <li>
<code class="highlighter-rouge">valid_pct</code> percentage of data that is available in validation set</li>
      <li>
<code class="highlighter-rouge">size</code> size of the images (generally 224*224 is prefered)</li>
      <li>
<code class="highlighter-rouge">ds_tfms</code> the required transformations that are needed. Like trimming, zooming and so on</li>
      <li>
<code class="highlighter-rouge">num_workers</code> the total number of worker threads that are needed to do the computations like transformation</li>
    </ul>
  </li>
  <li>We normalise the data so that the images are normalised the same way the pre trained model like <em>resnet34</em> are normalised</li>
</ul>

<p>Now we can do some basic analysis to see if we got the data right</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span><span class="o">.</span><span class="n">classes</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['Bharathanatyam', 'Kathak', 'Kathakali', 'jagoi dance']
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span><span class="o">.</span><span class="n">show_batch</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
</code></pre></div></div>

<p><img src="..%5Cimg%5Cposts%5C2018-11-08-learn-identifying-classical-dances%5Coutput_10_0.png" alt="png"></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span><span class="o">.</span><span class="n">classes</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">train_ds</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">valid_ds</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(['Bharathanatyam', 'Kathak', 'Kathakali', 'jagoi dance'], 4, 1957, 496)
</code></pre></div></div>

<p>Now after some analysis we find that these images like ok. So, leets start by looking into train the machine</p>

<h2 id="training-the-model">
<a class="anchor" href="#training-the-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Training the model</h2>

<p>As we are all set for training the machine, we can continue to train the machine learn the type of dance from image</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">learn</span> <span class="o">=</span> <span class="n">create_cnn</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span><span class="n">arch</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">resnet34</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">error_rate</span><span class="p">)</span>
</code></pre></div></div>

<p>Note that the method <code class="highlighter-rouge">error_rate</code> is available in the package <em>fastai</em>. So, getting the import is essential apart from <em>fastai.vision</em></p>

<p>Weâ€™ll now train the model</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Total time: 02:33
epoch  train_loss  valid_loss  error_rate
1      1.074674    0.658487    0.231855    (00:41)
2      0.814936    0.592159    0.211694    (00:39)
3      0.668678    0.592504    0.199597    (00:36)
4      0.570397    0.591368    0.189516    (00:36)
</code></pre></div></div>

<p>On training the last layer, we get an error of <em>18%</em> which is good start. We save the model as a checkpoint now.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">learn</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">'stage-1'</span><span class="p">)</span>
</code></pre></div></div>

<p>Now lets unfreeze all layers and try to make the entire neural network learn</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">learn</span><span class="o">.</span><span class="n">unfreeze</span><span class="p">()</span>
</code></pre></div></div>

<p>Now, lets try to identify the learning rate</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LR Finder complete, type {learner_name}.recorder.plot() to see the graph.
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">learn</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="..%5Cimg%5Cposts%5C2018-11-08-learn-identifying-classical-dances%5Coutput_25_0.png" alt="png"></p>

<p>Now, we see that somewhere around <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><msup><mi>e</mi><mo>âˆ’</mo></msup><mn>6</mn></mrow><annotation encoding="application/x-tex">3e^-6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">âˆ’</span></span></span></span></span></span></span></span><span class="mord">6</span></span></span></span> to be a good spot</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">max_lr</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mf">3e-7</span><span class="p">,</span><span class="mf">1e-6</span><span class="p">))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Total time: 02:29
epoch  train_loss  valid_loss  error_rate
1      0.453784    0.588463    0.191532    (00:37)
2      0.463598    0.588832    0.189516    (00:37)
3      0.472005    0.588780    0.191532    (00:38)
4      0.458501    0.586727    0.189516    (00:36)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">learn</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">'stage-2'</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="understanding-the-model">
<a class="anchor" href="#understanding-the-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Understanding the model</h2>

<p>After we save the model, we will analyse the model so that we can get enough information out of it</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">learn</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">'stage-2'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">interp</span> <span class="o">=</span> <span class="n">ClassificationInterpretation</span><span class="o">.</span><span class="n">from_learner</span><span class="p">(</span><span class="n">learn</span><span class="p">)</span>
</code></pre></div></div>

<p><strong>Confusion Matrix</strong> is a matrix which tabulates the Actual Vs Predicted output. If both are same, then out machine did great job in identifying the image. Lets see how our model preformed</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">interp</span><span class="o">.</span><span class="n">plot_confusion_matrix</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="..%5Cimg%5Cposts%5C2018-11-08-learn-identifying-classical-dances%5Coutput_34_0.png" alt="png"></p>

<p>As the picture says, the machine confuses a lot regarding <em>Bharathanatyam</em>. Well being from the region where it is famus, I might have some knowledge, lets see if thats helpful.</p>

<h2 id="cleanup">
<a class="anchor" href="#cleanup" aria-hidden="true"><span class="octicon octicon-link"></span></a>Cleanup</h2>

<p>There can be cases where some images are messy. Like, Google can give a search result which has a dancer who is famous in, say Bharathanatyam performing Kathak. These images can confuse the model in learning. Lets look if thats the case</p>

<p><em>FastAI</em> comes with this very cool widget which is very useful in these cases</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">fastai.widgets</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">losses</span><span class="p">,</span><span class="n">idxs</span> <span class="o">=</span> <span class="n">interp</span><span class="o">.</span><span class="n">top_losses</span><span class="p">()</span>
<span class="n">top_loss_paths</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">valid_ds</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">idxs</span><span class="p">]</span>
</code></pre></div></div>

<p>We got the list of losses and the top losses that are available. We canuse the widget to look for messy images</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fd</span> <span class="o">=</span> <span class="n">FileDeleter</span><span class="p">(</span><span class="n">file_paths</span><span class="o">=</span><span class="n">top_loss_paths</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HBox(children=(VBox(children=(Image(value=b'\xff\xd8\xff\xe0\x00\x10JFIF\x00\x01\x01\x01\x00H\x00H\x00\x00\xffâ€¦



Button(button_style='primary', description='Confirm', style=ButtonStyle())
</code></pre></div></div>

<p>Some common pitfalls that we can see is:</p>
<ul>
  <li>Many examples had images of probably famous dances that were taken during some interview or award ceremony</li>
  <li>Agenda of the dance festival</li>
  <li>The ornaments and dresses thats associated with that dance</li>
  <li>The image of artist while they do the make over or dressing while preparing for the dance.\</li>
</ul>

<p>Now, lets rerun the test. Find the learning rate, train the modelâ€¦</p>

<p>One thing to note. Since we deleted the images which had these pitfalls, we need to recreate the model with the available data, load the last best model and run these tests.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LR Finder complete, type {learner_name}.recorder.plot() to see the graph.
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">learn</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="..%5Cimg%5Cposts%5C2018-11-08-learn-identifying-classical-dances%5Coutput_44_0.png" alt="png"></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">max_lr</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mf">8e-8</span><span class="p">,</span><span class="mf">1e-6</span><span class="p">))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Total time: 02:31
epoch  train_loss  valid_loss  error_rate
1      0.508052    0.322376    0.106029    (00:38)
2      0.501633    0.319395    0.106029    (00:36)
3      0.498382    0.320848    0.106029    (00:36)
4      0.497239    0.319271    0.112266    (00:38)
</code></pre></div></div>

<p>Now, our new model looks better. Has around <em>11.2%</em> errors, which is like 88.8% accurate. That looks pleasing. Can we do better? Will update the blog if I do so.</p>

  </div><a class="u-url" href="/ml_posts/fast-ai/icrawler/2018/11/08/learn-identifying-classical-dances.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/ml_posts/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/ml_posts/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/ml_posts/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Personal Blogging Platform</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/nareshr8" title="nareshr8"><svg class="svg-icon grey"><use xlink:href="/ml_posts/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/nareshr8" title="nareshr8"><svg class="svg-icon grey"><use xlink:href="/ml_posts/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
