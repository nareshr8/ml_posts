<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Classify the Classical Dances of India - I | fastpages</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Classify the Classical Dances of India - I" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Download images of Different Classical Dances from Google" />
<meta property="og:description" content="Download images of Different Classical Dances from Google" />
<link rel="canonical" href="https://nareshr8.github.io/ml_posts/fast-ai/icrawler/2018/11/08/download-classical-dance.html" />
<meta property="og:url" content="https://nareshr8.github.io/ml_posts/fast-ai/icrawler/2018/11/08/download-classical-dance.html" />
<meta property="og:site_name" content="fastpages" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-11-08T00:00:00-06:00" />
<script type="application/ld+json">
{"datePublished":"2018-11-08T00:00:00-06:00","headline":"Classify the Classical Dances of India - I","description":"Download images of Different Classical Dances from Google","mainEntityOfPage":{"@type":"WebPage","@id":"https://nareshr8.github.io/ml_posts/fast-ai/icrawler/2018/11/08/download-classical-dance.html"},"@type":"BlogPosting","url":"https://nareshr8.github.io/ml_posts/fast-ai/icrawler/2018/11/08/download-classical-dance.html","dateModified":"2018-11-08T00:00:00-06:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/ml_posts/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://nareshr8.github.io/ml_posts/feed.xml" title="fastpages" /><link rel="shortcut icon" type="image/x-icon" href="/ml_posts/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Classify the Classical Dances of India - I | fastpages</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Classify the Classical Dances of India - I" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Download images of Different Classical Dances from Google" />
<meta property="og:description" content="Download images of Different Classical Dances from Google" />
<link rel="canonical" href="https://nareshr8.github.io/ml_posts/fast-ai/icrawler/2018/11/08/download-classical-dance.html" />
<meta property="og:url" content="https://nareshr8.github.io/ml_posts/fast-ai/icrawler/2018/11/08/download-classical-dance.html" />
<meta property="og:site_name" content="fastpages" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-11-08T00:00:00-06:00" />
<script type="application/ld+json">
{"datePublished":"2018-11-08T00:00:00-06:00","headline":"Classify the Classical Dances of India - I","description":"Download images of Different Classical Dances from Google","mainEntityOfPage":{"@type":"WebPage","@id":"https://nareshr8.github.io/ml_posts/fast-ai/icrawler/2018/11/08/download-classical-dance.html"},"@type":"BlogPosting","url":"https://nareshr8.github.io/ml_posts/fast-ai/icrawler/2018/11/08/download-classical-dance.html","dateModified":"2018-11-08T00:00:00-06:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://nareshr8.github.io/ml_posts/feed.xml" title="fastpages" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/ml_posts/">fastpages</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/ml_posts/about/">About Me</a><a class="page-link" href="/ml_posts/search/">Search</a><a class="page-link" href="/ml_posts/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Classify the Classical Dances of India - I</h1><p class="page-description">Download images of Different Classical Dances from Google</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2018-11-08T00:00:00-06:00" itemprop="datePublished">
        Nov 8, 2018
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      2 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/ml_posts/categories/#fast-ai">fast-ai</a>
        &nbsp;
      
        <a class="category-tags-link" href="/ml_posts/categories/#icrawler">icrawler</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#steps">Steps</a></li>
</ul><p>There are various classical dances that are available all throughout in India. These classical dances are culture specific. For example, Tamil Nadu follows a classical dance called Bharathanaatiyam where as its nearby state, Kerala has a classical dance of Kathakali.</p>

<p>Being not much knowledgable in any of the classical dances, I was triggered by the idea of Jeremy Howard who was suggesting that we might be able to solve deep learning problems even if we ourselves arent the domain experts. So, I decided to try myself out if I could build a model that can perform well in classifying the classical dance names.</p>

<h1 id="steps">
<a class="anchor" href="#steps" aria-hidden="true"><span class="octicon octicon-link"></span></a>Steps</h1>

<p>To build a classifier, we have to build a classifier on our own that can be run end to end, we need to follow the below steps.</p>

<ul>
  <li>Download the dataset</li>
  <li>Do preprocessing of data, if any</li>
  <li>Create a model to detect the classical dance</li>
</ul>

<p>I prefer installing the libraries usiing the notebook itself so that we can reuse it anytime as a package.</p>

<p>I use <em>icrawler</em> library to download data from the google and bing. Also <em>FastAI</em> library has this feature to check and delete the files which have the corrupted images.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># !pip install icrawler
# !pip install fastai
</span></code></pre></div></div>

<p>Now that we have installed all the required libraries, we could start downloading the dataset.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">icrawler.builtin</span> <span class="kn">import</span>  <span class="n">GoogleImageCrawler</span>
<span class="kn">from</span> <span class="nn">fastai.vision</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span>
<span class="kn">import</span> <span class="nn">logging</span>
</code></pre></div></div>

<p>We need to download images of few types of classical dance images for training the model.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">classes</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Bharathanatyam'</span><span class="p">,</span><span class="s">'Kathakali'</span><span class="p">,</span><span class="s">'Kathak'</span><span class="p">,</span><span class="s">'jagoi dance'</span><span class="p">]</span>
</code></pre></div></div>

<p>After we downloaded the images, we need to check if the downloaded images have some corrupt images as well. These images will not open for some reason and we dont want to train our network with these images.</p>

<p><em>Fast AI</em> comes with a method to verify these images using <code class="highlighter-rouge">verify_images</code> method</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">download_directory</span> <span class="o">=</span> <span class="s">'./data/dances/'</span><span class="o">+</span><span class="n">c</span>
    <span class="n">search_filters_google</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">google_crawler</span> <span class="o">=</span> <span class="n">GoogleImageCrawler</span><span class="p">(</span><span class="n">downloader_threads</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">storage</span><span class="o">=</span><span class="p">{</span><span class="s">'root_dir'</span><span class="p">:</span> <span class="n">download_directory</span><span class="p">})</span>
    <span class="n">google_crawler</span><span class="o">.</span><span class="n">crawl</span><span class="p">(</span><span class="n">keyword</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="n">search_filters_google</span><span class="p">,</span> <span class="n">max_num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">verify_images</span><span class="p">(</span><span class="n">download_directory</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">max_workers</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</code></pre></div></div>

<p>Now that we have downloaded the images we first check if the folder is created correctly</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="n">ls</span> <span class="n">data</span><span class="o">/</span><span class="n">dances</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Bharathanatyam	jagoi dance  Kathak  Kathakali
</code></pre></div></div>

<p>Now we can randomly check if the files are created correctly</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="n">ls</span> <span class="n">data</span><span class="o">/</span><span class="n">dances</span><span class="o">/</span><span class="s">'{classes[3]}'</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># !rm -r data/dances/*
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s">'data/dances/'</span><span class="o">+</span><span class="n">classes</span><span class="p">[</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)])</span>
<span class="k">print</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">pathiter</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">iterdir</span><span class="p">())</span>

<span class="n">open_image</span><span class="p">(</span><span class="n">pathiter</span><span class="p">[</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pathiter</span><span class="p">))])</span>
</code></pre></div></div>

<p>Kathak</p>

<p><img src="..%5Cimg%5Cposts%5C2018-11-08-classical-dance-i/output_16_1.png" alt="png"></p>

<p><strong>Note</strong>: This blog post is completely written in Jupyter notebook. Though, Some outputs that might be not suitable for blog reading are removed.</p>

<p>To create a model that learns from these images, look into the next part <a href="https://nareshr8.github.io/2018-11-08-learn-identifying-classical-dances/">here</a></p>

  </div><a class="u-url" href="/ml_posts/fast-ai/icrawler/2018/11/08/download-classical-dance.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/ml_posts/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/ml_posts/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/ml_posts/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/nareshr8" title="nareshr8"><svg class="svg-icon grey"><use xlink:href="/ml_posts/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/nareshr8" title="nareshr8"><svg class="svg-icon grey"><use xlink:href="/ml_posts/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
